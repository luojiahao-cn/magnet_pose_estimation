<launch>
    <!-- 参数：是否使用Gazebo仿真 -->
    <arg name="use_gazebo" default="false" />
    <!-- 参数：MoveIt日志输出位置，默认为log，可选screen -->
    <arg name="move_group_output" default="log"/>

    <!-- 根据参数选择不同的MoveIt配置 -->
    <group if="$(arg use_gazebo)">
        <include file="$(find fr5v6_single_moveit_config)/launch/demo_gazebo.launch" >
            <arg name="move_group_output" value="$(arg move_group_output)"/>
        </include>
    </group>

    <group unless="$(arg use_gazebo)">
        <include file="$(find frcobot_examples)/launch/connect_single_arm.launch">
            <arg name="use_rviz" value="false" />
        </include>

        <!-- Start RViz with our custom config -->
        <node name="rviz" pkg="rviz" type="rviz" args="-d $(find mag_arm_scan)/config/mag_arm_scan.rviz" />
    </group>

    <!-- 是否使用 MoveIt 附加的方式显示/考虑碰撞的支架工具 -->
    <arg name="use_attached_tool" default="true" />

    <!-- 如果不使用附加对象，可自行扩展其它可视化方式（此处已移除旧launch）-->

    <!-- 使用 MoveIt 附加对象方式，提供 attach/detach 服务 -->
    <group if="$(arg use_attached_tool)">
        <node pkg="mag_arm_scan" type="tool_manager_node" name="tool_manager" output="screen">
            <rosparam file="$(find mag_arm_scan)/config/scan_tool.yaml" command="load" />
        </node>
    </group>

    <node pkg="mag_arm_scan" type="scan_controller_with_recorder_node" name="scan_controller_with_recorder" output="screen">
        <rosparam file="$(find mag_arm_scan)/config/scan_controller_node.yaml" command="load" />
    </node>

</launch>